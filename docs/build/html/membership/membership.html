

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Provedor de Serviço de Associação (MSP) &mdash; hyperledger-fabricdocs master documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="hyperledger-fabricdocs master documentation" href="../index.html"/>
        <link rel="up" title="Conceitos Chave" href="../key_concepts.html"/>
        <link rel="next" title="Policies" href="../policies/policies.html"/>
        <link rel="prev" title="Identidade" href="../identity/identity.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          


          
            <a href="../index.html" class="icon icon-home"> hyperledger-fabricdocs
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          

<br><img style="background-color: #fff; height: unset; width: unset;" alt="Hyperledger Fabric" src=../_images/hyperledger_fabric_logo_color.png />
<br>
<a href="https://github.com/hyperledger/fabric"><img style="padding: 0px; margin: auto auto auto auto;" alt="GitHub" src="../_static/images/github_button.png"/></a>
&nbsp;<a href="https://stackoverflow.com/questions/tagged/hyperledger-fabric"><img style="padding: 0px; margin: auto auto auto auto;" alt="StackOverflow" src="../_static/images/stackoverflow_button.png"/></a>
&nbsp;<a href="https://chat.hyperledger.org"><img style="padding: 0px; margin: auto auto auto auto;" alt="Rocket Chat" src="../_static/images/rocketchat_button.png"/></a>
&nbsp;<a href="https://www.youtube.com/playlist?list=PL0MZ85B_96CH7wvtrRzV7SvtRY0sI0DEg"><img style="padding: 0px; margin: auto auto auto auto;" alt="Youtube Channel" src="../_static/images/youtube_button.png"/></a>

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../whatis.html">Introdução</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew.html">What’s new in Hyperledger Fabric v2.x</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew.html#release-notes">Release notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../key_concepts.html">Conceitos Chave</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../blockchain.html">Introdução</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fabric_model.html">Modelo Hyperledger Fabric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../network/network.html">Rede Blockchain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../identity/identity.html">Identidade</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Provedor de Serviço de Associação (MSP)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#por-que-preciso-de-um-msp">Por que preciso de um MSP?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#o-que-e-um-msp">O que é um MSP?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dominios-msp">Domínios MSP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#msps-locais">MSPs locais</a></li>
<li class="toctree-l4"><a class="reference internal" href="#msps-de-canal">MSPs de canal</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#qual-o-papel-de-uma-organizacao-em-um-msp">Qual o papel de uma organização em um MSP?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#unidades-organizacionais-ous-e-msps">Unidades Organizacionais (OUs) e MSPs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#papeis-da-ou-e-msps">Papéis da OU e MSPs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#estrutura-do-msp">Estrutura do MSP</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../policies/policies.html">Policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../peers/peers.html">Peers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ledger/ledger.html">Ledger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../orderer/ordering_service.html">The Ordering Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../smartcontract/smartcontract.html">Smart Contracts and Chaincode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chaincode_lifecycle.html">Fabric chaincode lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../private-data/private-data.html">Private data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../capabilities_concept.html">Channel capabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usecases.html">Use Cases</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developapps/developing_applications.html">Developing Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment_guide_overview.html">Deploying a production network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ops_guide.html">Operations Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrade.html">Upgrading to the latest release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_ref.html">Commands Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Architecture Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Fabric-FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributions Welcome!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossário</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../questions.html">Still Have Questions?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../status.html">Status</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hyperledger-fabricdocs</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../key_concepts.html">Conceitos Chave</a> &raquo;</li>
        
      <li>Provedor de Serviço de Associação (MSP)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/membership/membership.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="provedor-de-servico-de-associacao-msp">
<span id="provedor-de-servico-de-associacao-msp"></span><h1>Provedor de Serviço de Associação (MSP)<a class="headerlink" href="#provedor-de-servico-de-associacao-msp" title="Permalink to this headline">¶</a></h1>
<div class="section" id="por-que-preciso-de-um-msp">
<span id="por-que-preciso-de-um-msp"></span><h2>Por que preciso de um MSP?<a class="headerlink" href="#por-que-preciso-de-um-msp" title="Permalink to this headline">¶</a></h2>
<p>Como a Fabric é uma rede permissionada, os participantes da blockchain precisam
de uma maneira de provar sua identidade para o restante da rede, a fim de realizar
transações na rede. Se você leu a documentação sobre <a class="reference external" href="../identity/identity.html">Identidade</a>,
viu como uma PKI (Public Key Infrastructure) pode fornecer identidades verificáveis
​​por meio de uma cadeia de confiança. Como essa cadeia de confiança é usada pela
rede blockchain?</p>
<p>As autoridades de certificação emitem identidades gerando uma chave pública e
privada que forma um par de chaves que pode ser usado para provar a identidade.
Como uma chave privada nunca pode ser compartilhada publicamente, é necessário
um mecanismo para executar a prova, é onde o MSP entra. Por exemplo, um par usa
sua chave privada para assinar digitalmente ou endossar uma transação. O MSP no
serviço de pedidos contém a chave pública do par que é usada para verificar se a
assinatura anexada à transação é válida. A chave privada é usada para produzir
uma assinatura em uma transação que somente a chave pública correspondente, que
faz parte de um MSP, pode corresponder. Assim, o MSP é o mecanismo que permite
que essa identidade seja confiável e reconhecida pelo restante da rede sem nunca
revelar a chave privada do membro.</p>
<p>Lembre-se, no cenário do cartão de crédito, no tópico Identidade, que a Autoridade
de Certificação é como um fornecedor de cartões – ela distribui muitos tipos
diferentes de identidades verificáveis. Um MSP, por outro lado, determina quais
fornecedores de cartão de crédito são aceitos na loja. Dessa maneira, o MSP
transforma uma identidade (o cartão de crédito) em uma função (a capacidade de
comprar coisas na loja).</p>
<p>Essa capacidade de transformar identidades verificáveis em funções é fundamental
para o funcionamento das redes Fabric, pois permite que as organizações, nós e
canais estabeleçam MSPs que determinam quem tem permissão para fazer o que nos
níveis de organização, nó e canal.</p>
<p><img alt="MSP1a" src="../_images/membership.msp.diagram.png" /></p>
<p><em>As identidades são semelhantes aos seus cartões de crédito usados ​​para provar
que você pode pagar. O MSP é semelhante à lista de cartões de crédito aceitos.</em></p>
<p>Considere um consórcio de bancos que operam uma rede blockchain. Cada banco opera
nós pares e de ordens, e os pares endossam as transações enviadas à rede. No
entanto, cada banco também teria departamentos e correntistas. Os titulares da
conta pertenceriam a cada organização, mas não executariam nós na rede. Eles só
interagiriam com o sistema a partir de seus aplicativos móveis ou da web. Então,
como a rede reconhece e diferencia essas identidades? Uma CA foi usada para criar
as identidades, mas, como no exemplo do cartão, essas identidades não podem apenas
ser emitidas, elas precisam ser reconhecidas pela rede. MSPs são usados ​​para
definir as organizações confiáveis ​​pelos membros da rede. Os MSPs também são os
mecanismos que fornecem aos membros um conjunto de funções e permissões na rede.
Como os MSPs que definem essas organizações são conhecidos pelos membros de uma
rede, eles podem ser usados ​​para validar as entidades de rede que tentam executar
ações.</p>
<p>Por fim, considere se você deseja ingressar em uma rede <em>existente</em>, precisa de
uma maneira de transformar sua identidade em algo que seja reconhecido pela rede.
O MSP é o mecanismo que permite que você participe de uma rede blockchain
permissionada. Para realizar transações em uma rede Fabric, um membro precisa:</p>
<ol class="simple">
<li>Tenha uma identidade emitida por uma CA confiável pela rede.</li>
<li>Torne-se membro de uma <em>organização</em> que é reconhecida e aprovada pelos membros
da rede. O MSP é como a identidade está vinculada à associação de uma organização.
A associação é obtida adicionando a chave pública do membro (também conhecida como
certificado, certificado de assinatura ou certificado de assinatura) ao MSP da
organização.</li>
<li>Adicione o MSP a um <a class="reference external" href="../glossary.html#consorcio">consórcio</a> na rede ou em um canal.</li>
<li>Verifique se o MSP está incluído nas definições da <a class="reference external" href="../policies/policies.html">política</a>
da rede.</li>
</ol>
</div>
<div class="section" id="o-que-e-um-msp">
<span id="o-que-e-um-msp"></span><h2>O que é um MSP?<a class="headerlink" href="#o-que-e-um-msp" title="Permalink to this headline">¶</a></h2>
<p>Apesar do nome, o Provedor de Serviços para Membros não fornece nada. Em vez disso,
a implementação do requisito MSP é um conjunto de pastas que são adicionadas à
configuração da rede e são usadas para definir uma organização interna (as
organizações decidem quem são seus administradores) e externa (permitindo que
outras organizações validem que entidades tem autoridade para fazer o que eles
estão tentando fazer). Enquanto as autoridades de certificação geram os
certificados que representam identidades, o MSP contém uma lista de identidades
permitidas.</p>
<p>O MSP identifica quais CAs raises e intermediárias são aceitas para definir os
membros de um domínio confiável listando as identidades de seus membros ou
identificando quais CAs estão autorizadas a emitir identidades válidas para seus
membros.</p>
<p>Mas o poder de um MSP vai além de simplesmente listar quem é participante da rede
ou membro de um canal. É o MSP que transforma uma identidade em uma <strong>função</strong>,
identificando privilégios específicos que um ator possui em um nó ou canal.
Observe que, quando um usuário é registrado com uma Fabric CA, o papel de
administrador, nó, cliente, ordenação ou membro deve ser associada ao usuário.
Por exemplo, identidades registradas com a função “nó” devem, naturalmente, ser
atribuídas a um nó par. Da mesma forma, identidades registradas com a função
“admin” devem ser dadas aos administradores da organização. Iremos nos aprofundar
no significado dessas funções mais adiante neste tópico.</p>
<p>Além disso, um MSP pode permitir a identificação de uma lista de identidades que
foram revogadas – como discutido na documentação <a class="reference external" href="../identity/identity.html">Identidade</a> –,
mas falaremos sobre como esse processo também se estende a um MSP.</p>
</div>
<div class="section" id="dominios-msp">
<span id="dominios-msp"></span><h2>Domínios MSP<a class="headerlink" href="#dominios-msp" title="Permalink to this headline">¶</a></h2>
<p>MSPs ocorrem em dois domínios em uma rede blockchain:</p>
<ul class="simple">
<li>Localmente no nó de um ator (<strong>MSP local</strong>)</li>
<li>Na configuração do canal (<strong>channel MSP</strong>)</li>
</ul>
<p>A principal diferença entre os MSPs locais e de canal não é como eles funcionam
– ambos transformam identidades em papéis – mas seu <strong>escopo</strong>. Cada MSP lista
funções e permissões em um nível específico de administração.</p>
<div class="section" id="msps-locais">
<span id="msps-locais"></span><h3>MSPs locais<a class="headerlink" href="#msps-locais" title="Permalink to this headline">¶</a></h3>
<p><strong>MSPs locais são definidos para clientes e nós (nós pares e ordens)</strong>.
MSPs locais definem as permissões para um nó (que são os administradores de mesmo
nível que podem operar o nó, por exemplo). Os MSPs locais de clientes (os titulares
da conta no cenário bancário acima) permitem que o usuário se autentique em suas
transações como membro de um canal (por exemplo, em transações de chaincodes) ou
como proprietário de uma função específica no sistema, como administrador da
organização, por exemplo, em transações de configuração.</p>
<p><strong>Todo nó deve ter um MSP local definido</strong>, pois define quem possui direitos
administrativos ou participativos nesse nível (os administradores de nós pares
não serão necessariamente administradores de canal e vice-versa). Isso permite
autenticar mensagens de membros fora do contexto de um canal e definir as
permissões em um nó específico (que tem a capacidade de instalar o chaincode em
um par, por exemplo). Observe que um ou mais nós podem pertencer a uma organização.
Um MSP define os administradores da organização. E a organização, o administrador
da organização, o administrador do nó e o próprio nó devem ter a mesma raiz de
confiança.</p>
<p>Um MSP local do ordenador também é definido no sistema de arquivos do nó e se
aplica apenas a esse nó. Como nós pares, os pedidos também pertencem a uma única
organização e, portanto, têm um único MSP para listar os atores ou nós nos quais
confia.</p>
</div>
<div class="section" id="msps-de-canal">
<span id="msps-de-canal"></span><h3>MSPs de canal<a class="headerlink" href="#msps-de-canal" title="Permalink to this headline">¶</a></h3>
<p>Por outro lado, <strong>os MSPs de canal definem direitos administrativos e participativos
no nível do canal</strong>. Os pares e os nós de ordens em um canal de aplicativo
compartilham a mesma visualização dos MSPs do canal e, portanto, poderão autenticar
corretamente os participantes do canal. Isso significa que, se uma organização
desejar ingressar no canal, um MSP que incorpore a cadeia de confiança dos membros
da organização precisará ser incluído na configuração do canal. Caso contrário,
as transações originárias das identidades desta organização serão rejeitadas.
Enquanto os MSPs locais são representados como uma estrutura de pastas no sistema
de arquivos, os MSPs do canal são descritos em uma configuração de canal.</p>
<p><img alt="MSP1d" src="../_images/ChannelMSP.png" /></p>
<p><em>Snippet de um arquivo config.json do canal que inclui dois MSPs da organização.</em></p>
<p><strong>MSPs de canal identificam quem possui autoridades no nível do canal</strong>.
O canal MSP define a <em>relação</em> entre as identidades dos membros do canal (que são
MSPs) e a imposição de políticas no nível do canal. Os MSPs do canal contêm os
MSPs das organizações dos membros do canal.</p>
<p><strong>Toda organização que participa de um canal deve ter um MSP definido para ele</strong>.
De fato, é recomendável que haja um mapeamento individual entre organizações e MSPs.
O MSP define quais membros têm poderes para agir em nome da organização. Isso inclui
a configuração do próprio MSP, bem como a aprovação de tarefas administrativas que a
organização possui, como adicionar novos membros a um canal. Se todos os membros da
rede faziam parte de uma única organização ou MSP, a privacidade dos dados é
sacrificada. Várias organizações facilitam a privacidade segregando dados do
livro-razão apenas para membros do canal. Se for necessária mais granularidade
dentro de uma organização, ela poderá ser dividida em unidades organizacionais (OUs)
que descrevemos em mais detalhes a frente neste tópico.</p>
<p><strong>O canal do sistema MSP inclui os MSPs de todas as organizações que participam
de um serviço de ordens.</strong> Um serviço de ordens provavelmente incluirá nós de
ordens de várias organizações e, coletivamente, essas organizações executam o
serviço de ordens, gerenciando o consórcio de organizações e as políticas padrão
que são herdadas pelos canais de aplicativos.</p>
<p><strong>MSPs locais são definidos apenas no sistema de arquivos do nó ou usuário</strong> ao
qual eles se aplicam. Portanto, fisicamente e logicamente, há apenas um MSP local
por nó. No entanto, como os MSPs do canal estão disponíveis para todos os nós no
canal, eles são definidos logicamente uma vez na configuração do canal. No entanto,
<strong>um canal MSP também é instanciado no sistema de arquivos de todos os nós no canal
e mantido sincronizado por consenso</strong>. Portanto, embora exista uma cópia de cada
MSP de canal no sistema de arquivos local de cada nó, logicamente um MSP de canal
reside e é mantido pelo canal ou pela rede.</p>
<p>O diagrama a seguir ilustra como os MSPs locais e de canal coexistem na rede:</p>
<p><img alt="MSP3" src="../_images/membership.diagram.2.png" /></p>
<p><em>Os MSPs do nó e do solicitante são locais, enquanto os MSPs de um canal (incluindo
o canal de configuração de rede, também conhecido como canal do sistema) são
globais, compartilhados entre todos os participantes desse canal. Nesta figura,
o canal do sistema de rede é administrado pelo ORG1, mas outro canal de aplicativo
pode ser gerenciado pelo ORG1 e ORG2. O par é um membro e é gerenciado pelo ORG2,
enquanto o ORG1 gerencia o ordenador da figura. O ORG1 confia nas identidades do
RCA1, enquanto o ORG2 confia nas identidades do RCA2. É importante observar que
essas são identidades de administração, refletindo quem pode administrar esses
componentes. Portanto, enquanto o ORG1 administra a rede, o ORG2.MSP existe na
definição de rede.</em></p>
</div>
</div>
<div class="section" id="qual-o-papel-de-uma-organizacao-em-um-msp">
<span id="qual-o-papel-de-uma-organizacao-em-um-msp"></span><h2>Qual o papel de uma organização em um MSP?<a class="headerlink" href="#qual-o-papel-de-uma-organizacao-em-um-msp" title="Permalink to this headline">¶</a></h2>
<p>Uma <strong>organização</strong> é um grupo lógico de membros gerenciados. Isso pode ser algo
tão grande quanto uma corporação multinacional ou tão pequeno quanto uma loja de
flores. O mais importante sobre as organizações (ou <strong>orgs</strong>) é que elas gerenciam
seus membros em um único MSP. O MSP permite que uma identidade seja vinculada a
uma organização. Observe que isso é diferente do conceito de organização definido
em um certificado X.509, que mencionamos acima.</p>
<p>O relacionamento exclusivo entre uma organização e seu MSP torna sensato nomear
o MSP após a organização, uma convenção que você encontrará adotada na maioria
das configurações de políticas. Por exemplo, a organização <code class="docutils literal notranslate"><span class="pre">ORG1</span></code> provavelmente
teria um MSP chamado algo como <code class="docutils literal notranslate"><span class="pre">ORG1-MSP</span></code>. Em alguns casos, uma organização pode
exigir vários grupos de associação — por exemplo, onde os canais são usados ​​
para executar funções comerciais muito diferentes entre as organizações. Nesses
casos, faz sentido ter vários MSPs e nomeá-los adequadamente, por exemplo,
<code class="docutils literal notranslate"><span class="pre">ORG2-MSP-NATIONAL</span></code> e <code class="docutils literal notranslate"><span class="pre">ORG2-MSP-GOVERNMENT</span></code>, refletindo as diferentes raízes de
confiança da associação dentro do <code class="docutils literal notranslate"><span class="pre">ORG2</span></code> nas vendas <code class="docutils literal notranslate"><span class="pre">NATIONAL</span></code> canal em
comparação com o canal regulatório <code class="docutils literal notranslate"><span class="pre">GOVERNO</span></code>.</p>
<div class="section" id="unidades-organizacionais-ous-e-msps">
<span id="unidades-organizacionais-ous-e-msps"></span><h3>Unidades Organizacionais (OUs) e MSPs<a class="headerlink" href="#unidades-organizacionais-ous-e-msps" title="Permalink to this headline">¶</a></h3>
<p>Uma organização também pode ser dividida em várias <strong>unidades organizacionais</strong>,
cada uma das quais com um certo conjunto de responsabilidades, também chamadas de
<code class="docutils literal notranslate"><span class="pre">afiliações</span></code>. Pense em uma UO como um departamento dentro de uma organização. Por
exemplo, a organização <code class="docutils literal notranslate"><span class="pre">ORG1</span></code> pode ter UOs <code class="docutils literal notranslate"><span class="pre">ORG1.MANUFACTURING</span></code> e <code class="docutils literal notranslate"><span class="pre">ORG1.DISTRIBUTION</span></code>
para refletir essas linhas de negócios separadas. Quando uma CA emite certificados
X.509, o campo <code class="docutils literal notranslate"><span class="pre">OU</span></code> no certificado especifica a linha de negócios à qual a
identidade pertence. Um benefício do uso de OUs como esse é que esses valores
podem ser usados nas definições de política para restringir o acesso ou em
contratos inteligentes para controle de acesso baseado em atributos. Caso
contrário, MSPs separados precisariam ser criados para cada organização.</p>
<p>A especificação de UOs é opcional. Se as OUs não forem usadas, todas as identidades
que fazem parte de um MSP – como identificadas pelas pastas CA raiz e CA
intermediária – serão consideradas membros da organização.</p>
</div>
<div class="section" id="papeis-da-ou-e-msps">
<span id="papeis-da-ou-e-msps"></span><h3>Papéis da OU e MSPs<a class="headerlink" href="#papeis-da-ou-e-msps" title="Permalink to this headline">¶</a></h3>
<p>Além disso, existe um tipo especial de OU, às vezes chamada de <code class="docutils literal notranslate"><span class="pre">Node</span> <span class="pre">OU</span></code>, que
pode ser usada para conferir uma função a uma identidade. Essas funções da OU do
nó são definidas no arquivo <code class="docutils literal notranslate"><span class="pre">$FABRIC_CFG_PATH/msp/config.yaml</span></code> e contêm uma lista
de unidades organizacionais cujos membros são considerados parte da organização
representada por este MSP. Isso é particularmente útil quando você deseja
restringir os membros de uma organização àqueles que possuem uma identidade
(assinada por uma das CAs designadas pelo MSP) com uma função específica de OU
do nó. Por exemplo, com OUs de nó, você pode implementar uma política de endosso
mais granular que exige que os nós pares Org1 endossem uma transação, em vez de
qualquer membro da Org1.</p>
<p>Para usar as funções da OU do Nó, o recurso “classificação de identidade” deve
estar ativado para a rede. Ao usar a estrutura MSP baseada em pasta, isso é feito
ativando “OUs de nó” no arquivo config.yaml, que reside na raiz da pasta MSP:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NodeOUs</span><span class="p">:</span>
  <span class="n">Enable</span><span class="p">:</span> <span class="n">true</span>
  <span class="n">ClientOUIdentifier</span><span class="p">:</span>
    <span class="n">Certificate</span><span class="p">:</span> <span class="n">cacerts</span><span class="o">/</span><span class="n">ca</span><span class="o">.</span><span class="n">sampleorg</span><span class="o">-</span><span class="n">cert</span><span class="o">.</span><span class="n">pem</span>
    <span class="n">OrganizationalUnitIdentifier</span><span class="p">:</span> <span class="n">client</span>
  <span class="n">PeerOUIdentifier</span><span class="p">:</span>
    <span class="n">Certificate</span><span class="p">:</span> <span class="n">cacerts</span><span class="o">/</span><span class="n">ca</span><span class="o">.</span><span class="n">sampleorg</span><span class="o">-</span><span class="n">cert</span><span class="o">.</span><span class="n">pem</span>
    <span class="n">OrganizationalUnitIdentifier</span><span class="p">:</span> <span class="n">peer</span>
  <span class="n">AdminOUIdentifier</span><span class="p">:</span>
    <span class="n">Certificate</span><span class="p">:</span> <span class="n">cacerts</span><span class="o">/</span><span class="n">ca</span><span class="o">.</span><span class="n">sampleorg</span><span class="o">-</span><span class="n">cert</span><span class="o">.</span><span class="n">pem</span>
    <span class="n">OrganizationalUnitIdentifier</span><span class="p">:</span> <span class="n">admin</span>
  <span class="n">OrdererOUIdentifier</span><span class="p">:</span>
    <span class="n">Certificate</span><span class="p">:</span> <span class="n">cacerts</span><span class="o">/</span><span class="n">ca</span><span class="o">.</span><span class="n">sampleorg</span><span class="o">-</span><span class="n">cert</span><span class="o">.</span><span class="n">pem</span>
    <span class="n">OrganizationalUnitIdentifier</span><span class="p">:</span> <span class="n">orderer</span>
</pre></div>
</div>
<p>No exemplo acima, existem 4 possíveis Nós OU <code class="docutils literal notranslate"><span class="pre">ROLES</span></code> para o MSP:</p>
<ul class="simple">
<li>cliente (client)</li>
<li>par (peer)</li>
<li>admin (admin)</li>
<li>ordenador (orderer)</li>
</ul>
<p>Esta convenção permite distinguir funções do MSP pela OU presente no atributo
CommonName do certificado X509. O exemplo acima diz que qualquer certificado
emitido por cacerts/ca.sampleorg-cert.pem no qual OU=client será identificado
como cliente, OU=peer como nó, etc. A partir do Fabric v1.4.3, também há uma OU
para o ordenador e para administradores. A nova função de administrador significa
que você não precisa mais colocar explicitamente certs na pasta admincerts do
diretório MSP. Em vez disso, a função <code class="docutils literal notranslate"><span class="pre">admin</span></code> presente no signcert do usuário
qualifica a identidade como um usuário administrador.</p>
<p>Esses atributos de função e OU são atribuídos a uma identidade quando o CA ou
SDK da Fabric é usado para <code class="docutils literal notranslate"><span class="pre">registrar</span></code> um usuário na CA. É o comando do usuário
<code class="docutils literal notranslate"><span class="pre">register</span></code> subsequente que gera os certificados na pasta <code class="docutils literal notranslate"><span class="pre">/msp</span></code> dos usuários.</p>
<p><img alt="MSP1c" src="../_images/ca-msp-visualization.png" /></p>
<p>Os atributos ROLE e OU resultantes são visíveis dentro do certificado de assinatura
X.509 localizado na pasta <code class="docutils literal notranslate"><span class="pre">/signcerts</span></code>. O atributo <code class="docutils literal notranslate"><span class="pre">ROLE</span></code> é identificado como
<code class="docutils literal notranslate"><span class="pre">hf.Type</span></code> e refere-se à função de um ator dentro de sua organização (especificando,
por exemplo, que um ator é um <code class="docutils literal notranslate"><span class="pre">par</span></code>). Veja a seguir o pedaço de um certificado de
assinatura mostra como as Funções e OUs são representadas no certificado.</p>
<p><img alt="MSP1d" src="../_images/signcert.png" /></p>
<p><strong>Nota:</strong> Para MSPs de canal, apenas porque um ator tem o papel de administrador,
isso não significa que eles podem administrar recursos específicos. O poder real
de uma determinada identidade em relação à administração do sistema é determinado
pelas <em>políticas</em> que gerenciam os recursos do sistema. Por exemplo, uma política
de canal pode especificar que os administradores do <code class="docutils literal notranslate"><span class="pre">ORG1-MANUFACTURING</span></code>, ou seja,
identidades com a função de <code class="docutils literal notranslate"><span class="pre">admin</span></code> e uma OU do nó da <code class="docutils literal notranslate"><span class="pre">ORG1-MANUFACTURING</span></code>, tenham
o direito de adicionar novas organizações ao canal, enquanto os administradores da
<code class="docutils literal notranslate"><span class="pre">ORG1-DISTRIBUTION</span></code> não têm esses direitos.</p>
<p>Finalmente, as OUs podem ser usadas por diferentes organizações em um consórcio
para se distinguir. Porém, nesses casos, as diferentes organizações precisam usar
as mesmas CAs raiz e intermediárias para sua cadeia de confiança e atribuir o
campo OU para identificar membros de cada organização. Quando toda organização
tem a mesma CA ou cadeia de confiança, isso torna o sistema mais centralizado do
que seria desejável e, portanto, merece uma atenção cuidadosa em uma rede blockchain.</p>
</div>
</div>
<div class="section" id="estrutura-do-msp">
<span id="estrutura-do-msp"></span><h2>Estrutura do MSP<a class="headerlink" href="#estrutura-do-msp" title="Permalink to this headline">¶</a></h2>
<p>Vamos explorar os elementos MSP que estruturam a funcionalidade que descrevemos
até agora.</p>
<p>Uma pasta MSP local contém as seguintes subpastas:</p>
<p><img alt="MSP6" src="../_images/membership.diagram.6.png" /></p>
<p><em>A figura acima mostra as subpastas em um MSP local no sistema de arquivos</em></p>
<ul>
<li><p class="first"><strong>config.yaml:</strong> Usado para configurar o recurso de classificação de identidade
no Fabric, ativando “OUs de nó” e definindo as funções aceitas.</p>
</li>
<li><p class="first"><strong>cacerts:</strong> Esta pasta contém uma lista de certificados X.509 autoassinados
das CAs raiz confiáveis pela organização representada por este MSP. Deve haver
pelo menos um certificado de CA raiz nesta pasta MSP.</p>
<p>Essa é a pasta mais importante porque identifica as CAs das quais todos os
outros certificados devem ser derivados para serem considerados membros da
organização correspondente para formar a cadeia de confiança.</p>
</li>
<li><p class="first"><strong>intermediatecerts:</strong> Esta pasta contém uma lista de certificados X.509 das
CAs intermediárias creditadas ​​por esta organização. Cada certificado deve ser
assinado por uma das CAs raiz no MSP ou por qualquer CA intermediária cuja cadeia
de CA emissora finalmente retorne a uma CA raiz confiável.</p>
<p>Uma CA intermediária pode representar uma subdivisão diferente da organização
(como <code class="docutils literal notranslate"><span class="pre">ORG1-MANUFACTURING</span></code> e <code class="docutils literal notranslate"><span class="pre">ORG1-DISTRIBUTION</span></code> fazem para <code class="docutils literal notranslate"><span class="pre">ORG1</span></code>) ou a própria
organização (como pode ser o caso se uma CA comercial for alavancada para a
organização). Gerenciamento de identidade). No último caso, as CAs intermediárias podem ser usadas para representar subdivisões da organização. [Aqui] (../ msp.html), você pode encontrar mais informações sobre práticas recomendadas para a configuração do MSP. Observe que é possível ter uma rede em funcionamento que não possua uma CA intermediária; nesse caso, essa pasta estaria vazia.</p>
<p>Como a pasta CA raiz, essa pasta define as CAs das quais os certificados devem ser emitidos para serem considerados membros da organização.</p>
</li>
<li><p class="first"><strong>intermediatecerts:</strong> This folder contains a list of X.509 certificates of the Intermediate CAs trusted by this organization. Each certificate must be signed by one of the Root CAs in the MSP or by any Intermediate CA whose issuing CA chain ultimately leads back to a trusted Root CA.</p>
<p>An intermediate CA may represent a different subdivision of the organization (like <code class="docutils literal notranslate"><span class="pre">ORG1-MANUFACTURING</span></code> and <code class="docutils literal notranslate"><span class="pre">ORG1-DISTRIBUTION</span></code> do for <code class="docutils literal notranslate"><span class="pre">ORG1</span></code>), or the
organization itself (as may be the case if a commercial CA is leveraged for the organization’s identity management). In the latter case intermediate CAs
can be used to represent organization subdivisions. <a class="reference external" href="../msp.html">Here</a> you may find more information on best practices for MSP configuration. Notice, that
it is possible to have a functioning network that does not have an Intermediate CA, in which case this folder would be empty.</p>
<p>Like the Root CA folder, this folder defines the CAs from which certificates must be issued to be considered members of the organization.</p>
</li>
<li><p class="first"><strong>admincerts (Deprecated from Fabric v1.4.3 and higher):</strong> This folder contains a list of identities that define the actors who have the role of administrators for this organization. In general, there should be one or more X.509 certificates in this list.</p>
<p><strong>Note:</strong> Prior to Fabric v1.4.3, admins were defined by explicitly putting certs in the <code class="docutils literal notranslate"><span class="pre">admincerts</span></code> folder in the local MSP directory of your peer. <strong>With Fabric v1.4.3 or higher, certificates in this folder are no longer required.</strong> Instead, it is recommended that when the user is registered with the CA, that the <code class="docutils literal notranslate"><span class="pre">admin</span></code> role is used to designate the node administrator. Then, the identity is recognized as an <code class="docutils literal notranslate"><span class="pre">admin</span></code> by the Node OU role value in their signcert. As a reminder, in order to leverage the admin role, the “identity classification” feature must be enabled in the config.yaml above by setting “Node OUs” to <code class="docutils literal notranslate"><span class="pre">Enable:</span> <span class="pre">true</span></code>. We’ll explore this more later.</p>
<p>And as a reminder, for Channel MSPs, just because an actor has the role of an administrator it doesn’t mean that they can administer particular resources. The actual power a given identity has with respect to administering the system is determined by the <em>policies</em> that manage system resources. For example, a channel policy might specify that <code class="docutils literal notranslate"><span class="pre">ORG1-MANUFACTURING</span></code> administrators have the rights to add new organizations to the channel, whereas the <code class="docutils literal notranslate"><span class="pre">ORG1-DISTRIBUTION</span></code> administrators have no such rights.</p>
</li>
<li><p class="first"><strong>keystore: (private Key)</strong> This folder is defined for the local MSP of a peer or orderer node (or in a client’s local MSP), and contains the node’s private key. This key is used to sign data — for example to sign a transaction proposal response, as part of the endorsement phase.</p>
<p>This folder is mandatory for local MSPs, and must contain exactly one private key. Obviously, access to this folder must be limited only to the identities of users who have administrative responsibility on the peer.</p>
<p>The <strong>channel MSP</strong> configuration does not include this folder, because channel MSPs solely aim to offer identity validation functionalities and not signing abilities.</p>
<p><strong>Note:</strong> If you are using a <a class="reference external" href="../hsm.html">Hardware Security Module(HSM)</a> for key management, this folder is empty because the private key is generated by and stored in the HSM.</p>
</li>
<li><p class="first"><strong>signcert:</strong> For a peer or orderer node (or in a client’s local MSP) this folder contains the node’s <strong>signing key</strong>. This key matches cryptographically the node’s identity included in <strong>Node Identity</strong> folder and is used to sign data — for example to sign a transaction proposal response, as part of the endorsement phase.</p>
<p>This folder is mandatory for local MSPs, and must contain exactly one public key. Obviously, access to this folder must be limited only to the identities of users who have  administrative responsibility on the peer.</p>
<p>Configuration of a <strong>channel MSP</strong> does not include this folder, as channel MSPs solely aim to offer identity validation functionalities and not signing abilities.</p>
</li>
<li><p class="first"><strong>tlscacerts:</strong> This folder contains a list of self-signed X.509 certificates of the Root CAs trusted by this organization <strong>for secure communications between nodes using TLS</strong>. An example of a TLS communication would be when a peer needs to connect to an orderer so that it can receive ledger updates.</p>
<p>MSP TLS information relates to the nodes inside the network — the peers and the orderers, in other words, rather than the applications and administrations that consume the network.</p>
<p>There must be at least one TLS Root CA certificate in this folder. For more information about TLS, see <a class="reference external" href="../enable_tls.html">Securing Communication with Transport Layer Security (TLS)</a>.</p>
</li>
<li><p class="first"><strong>tlsintermediatecacerts:</strong> This folder contains a list intermediate CA certificates CAs trusted by the organization represented by this MSP <strong>for secure communications between nodes using TLS</strong>. This folder is specifically useful when commercial CAs are used for TLS certificates of an organization. Similar to membership intermediate CAs, specifying intermediate TLS CAs is optional.</p>
</li>
<li><p class="first"><strong>operationscerts:</strong> This folder contains the certificates required to communicate with the <a class="reference external" href="../operations_service.html">Fabric Operations Service</a> API.</p>
</li>
</ul>
<p>A channel MSP includes the following additional folder:</p>
<ul>
<li><p class="first"><strong>Revoked Certificates:</strong> If the identity of an actor has been revoked, identifying information about the identity — not the identity itself — is held in this folder. For X.509-based identities, these identifiers are pairs of strings known as Subject Key Identifier (SKI) and Authority Access Identifier (AKI), and are checked whenever the certificate is being used to make sure the certificate has not been revoked.</p>
<p>This list is conceptually the same as a CA’s Certificate Revocation List (CRL), but it also relates to revocation of membership from the organization. As a result, the administrator of a channel MSP can quickly revoke an actor or node from an organization by advertising the updated CRL of the CA. This “list of lists” is optional. It will only become populated as certificates are revoked.</p>
</li>
</ul>
<p>If you’ve read this doc as well as our doc on <a class="reference external" href="../identity/identity.html">Identity</a>, you
should now have a pretty good grasp of how identities and MSPs work in Hyperledger Fabric.
You’ve seen how a PKI and MSPs are used to identify the actors collaborating in a blockchain
network. You’ve learned how certificates, public/private keys, and roots of trust work,
in addition to how MSPs are physically and logically structured.</p>
<!---
Licensed under Creative Commons Attribution 4.0 International License https://creativecommons.org/licenses/by/4.0/
--></div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../policies/policies.html" class="btn btn-neutral float-right" title="Policies" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../identity/identity.html" class="btn btn-neutral" title="Identidade" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Hyperledger 2020.
    <br>
      <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
        <img alt="Creative Commons License" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'master',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>