

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Enabling the new chaincode lifecycle &mdash; hyperledger-fabricdocs master documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="hyperledger-fabricdocs master documentation" href="index.html"/>
        <link rel="up" title="Upgrading to the latest release" href="upgrade.html"/>
        <link rel="next" title="Commands Reference" href="command_ref.html"/>
        <link rel="prev" title="Updating the capability level of a channel" href="updating_capabilities.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          


          
            <a href="index.html" class="icon icon-home"> hyperledger-fabricdocs
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          

<br><img style="background-color: #fff; height: unset; width: unset;" alt="Hyperledger Fabric" src=_images/hyperledger_fabric_logo_color.png />
<br>
<a href="https://github.com/hyperledger/fabric"><img style="padding: 0px; margin: auto auto auto auto;" alt="GitHub" src="_static/images/github_button.png"/></a>
&nbsp;<a href="https://stackoverflow.com/questions/tagged/hyperledger-fabric"><img style="padding: 0px; margin: auto auto auto auto;" alt="StackOverflow" src="_static/images/stackoverflow_button.png"/></a>
&nbsp;<a href="https://chat.hyperledger.org"><img style="padding: 0px; margin: auto auto auto auto;" alt="Rocket Chat" src="_static/images/rocketchat_button.png"/></a>
&nbsp;<a href="https://www.youtube.com/playlist?list=PL0MZ85B_96CH7wvtrRzV7SvtRY0sI0DEg"><img style="padding: 0px; margin: auto auto auto auto;" alt="Youtube Channel" src="_static/images/youtube_button.png"/></a>

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="whatis.html">Introdução</a></li>
<li class="toctree-l1"><a class="reference internal" href="whatsnew.html">What’s new in Hyperledger Fabric v2.x</a></li>
<li class="toctree-l1"><a class="reference internal" href="whatsnew.html#release-notes">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="key_concepts.html">Principais Conceitos</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="developapps/developing_applications.html">Developing Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment_guide_overview.html">Deploying a production network</a></li>
<li class="toctree-l1"><a class="reference internal" href="ops_guide.html">Operations Guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="upgrade.html">Upgrading to the latest release</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="upgrade_to_newest_version.html">Considerations for getting to v2.x</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading_your_components.html">Upgrading your components</a></li>
<li class="toctree-l2"><a class="reference internal" href="updating_capabilities.html">Updating the capability level of a channel</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Enabling the new chaincode lifecycle</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-enable-lifecycle-json">Create <code class="docutils literal notranslate"><span class="pre">enable_lifecycle.json</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#edit-the-channel-configurations">Edit the channel configurations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#system-channel-updates">System channel updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#application-channel-updates">Application channel updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#enable-new-lifecycle-in-core-yaml">Enable new lifecycle in <code class="docutils literal notranslate"><span class="pre">core.yaml</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="command_ref.html">Commands Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fabric-FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributions Welcome!</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="questions.html">Still Have Questions?</a></li>
<li class="toctree-l1"><a class="reference internal" href="status.html">Status</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">hyperledger-fabricdocs</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="upgrade.html">Upgrading to the latest release</a> &raquo;</li>
        
      <li>Enabling the new chaincode lifecycle</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/enable_cc_lifecycle.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="enabling-the-new-chaincode-lifecycle">
<span id="enabling-the-new-chaincode-lifecycle"></span><h1>Enabling the new chaincode lifecycle<a class="headerlink" href="#enabling-the-new-chaincode-lifecycle" title="Permalink to this headline">¶</a></h1>
<p>Users upgrading from v1.4.x to v2.0 will have to edit their channel configurations to enable the new lifecycle features. This process involves a series of <a class="reference external" href="./config_update.html">channel configuration updates</a> the relevant users will have to perform.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">Channel</span></code> and <code class="docutils literal notranslate"><span class="pre">Application</span></code> <a class="reference external" href="./capabilities_concept.html">capabilities</a> of your application channels will have to be updated to <code class="docutils literal notranslate"><span class="pre">V2_0</span></code> for the new chaincode lifecycle to work. Check out <a class="reference external" href="./upgrade_to_newest_version.html#chaincode-lifecycle">Considerations for getting to 2.0</a> for more information.</p>
<p>Updating a channel configuration is, at a high level, a three step process (for each channel):</p>
<ol class="simple">
<li>Get the latest channel config</li>
<li>Create a modified channel config</li>
<li>Create a config update transaction</li>
</ol>
<p>We will be performing these channel configuration updates by leveraging a file called <code class="docutils literal notranslate"><span class="pre">enable_lifecycle.json</span></code>, which contains all of the updates we will be making in the channel configurations. Note that in a production setting it is likely that multiple users would be making these channel update requests. However, for the sake of simplicity, we are presenting all of the updates as how they would appear in a single file.</p>
<div class="section" id="create-enable-lifecycle-json">
<span id="create-enable-lifecycle-json"></span><h2>Create <code class="docutils literal notranslate"><span class="pre">enable_lifecycle.json</span></code><a class="headerlink" href="#create-enable-lifecycle-json" title="Permalink to this headline">¶</a></h2>
<p>Note that in addition to using <code class="docutils literal notranslate"><span class="pre">enable_lifecycle.json</span></code>, this tutorial also uses <code class="docutils literal notranslate"><span class="pre">jq</span></code> to apply the edits to the modified config file. The modified config can also be edited manually (after it has been pulled, translated, and scoped). Check out this <a class="reference external" href="./config_update.html#sample-channel-configuration">sample channel configuration</a> for reference.</p>
<p>However, the process described here (using a JSON file and a tool like <code class="docutils literal notranslate"><span class="pre">jq</span></code>) does have the advantage of being scriptable, making it suitable for proposing configuration updates to a large number of channels, and is the recommended process for editing a channel configuration.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">enable_lifecycle.json</span></code> uses sample values, for example <code class="docutils literal notranslate"><span class="pre">org1Policies</span></code> and the <code class="docutils literal notranslate"><span class="pre">Org1ExampleCom</span></code>, which will be specific to your deployment):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;org1Policies&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;Endorsement&quot;</span><span class="p">:</span> <span class="p">{</span>
           <span class="s2">&quot;mod_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;Admins&quot;</span><span class="p">,</span>
           <span class="s2">&quot;policy&quot;</span><span class="p">:</span> <span class="p">{</span>
               <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
               <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
               <span class="s2">&quot;identities&quot;</span><span class="p">:</span> <span class="p">[</span>
                  <span class="p">{</span>
                     <span class="s2">&quot;principal&quot;</span><span class="p">:</span> <span class="p">{</span>
                         <span class="s2">&quot;msp_identifier&quot;</span><span class="p">:</span> <span class="s2">&quot;Org1ExampleCom&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;PEER&quot;</span>
                     <span class="p">},</span>
                     <span class="s2">&quot;principal_classification&quot;</span><span class="p">:</span> <span class="s2">&quot;ROLE&quot;</span>
                  <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;n_out_of&quot;</span><span class="p">:</span> <span class="p">{</span>
                       <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                       <span class="s2">&quot;rules&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;signed_by&quot;</span><span class="p">:</span> <span class="mi">0</span>
                        <span class="p">}</span>
                       <span class="p">]</span>
                   <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">0</span>
              <span class="p">}</span>
           <span class="p">},</span>
           <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
      <span class="p">}</span>
   <span class="p">},</span>
  <span class="s2">&quot;org2Policies&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;Endorsement&quot;</span><span class="p">:</span> <span class="p">{</span>
           <span class="s2">&quot;mod_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;Admins&quot;</span><span class="p">,</span>
           <span class="s2">&quot;policy&quot;</span><span class="p">:</span> <span class="p">{</span>
               <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
               <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
               <span class="s2">&quot;identities&quot;</span><span class="p">:</span> <span class="p">[</span>
                  <span class="p">{</span>
                     <span class="s2">&quot;principal&quot;</span><span class="p">:</span> <span class="p">{</span>
                         <span class="s2">&quot;msp_identifier&quot;</span><span class="p">:</span> <span class="s2">&quot;Org2ExampleCom&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;PEER&quot;</span>
                     <span class="p">},</span>
                     <span class="s2">&quot;principal_classification&quot;</span><span class="p">:</span> <span class="s2">&quot;ROLE&quot;</span>
                  <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;n_out_of&quot;</span><span class="p">:</span> <span class="p">{</span>
                       <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                       <span class="s2">&quot;rules&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;signed_by&quot;</span><span class="p">:</span> <span class="mi">0</span>
                        <span class="p">}</span>
                       <span class="p">]</span>
                   <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">0</span>
              <span class="p">}</span>
           <span class="p">},</span>
           <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
      <span class="p">}</span>
   <span class="p">},</span>
   <span class="s2">&quot;appPolicies&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;Endorsement&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;mod_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;Admins&quot;</span><span class="p">,</span>
            <span class="s2">&quot;policy&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="s2">&quot;MAJORITY&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;sub_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;Endorsement&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;LifecycleEndorsement&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;mod_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;Admins&quot;</span><span class="p">,</span>
            <span class="s2">&quot;policy&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="s2">&quot;MAJORITY&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;sub_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;Endorsement&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
        <span class="p">}</span>
   <span class="p">},</span>
   <span class="s2">&quot;acls&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;_lifecycle/CheckCommitReadiness&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;policy_ref&quot;</span><span class="p">:</span> <span class="s2">&quot;/Channel/Application/Writers&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;_lifecycle/CommitChaincodeDefinition&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;policy_ref&quot;</span><span class="p">:</span> <span class="s2">&quot;/Channel/Application/Writers&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;_lifecycle/QueryChaincodeDefinition&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;policy_ref&quot;</span><span class="p">:</span> <span class="s2">&quot;/Channel/Application/Readers&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;_lifecycle/QueryChaincodeDefinitions&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;policy_ref&quot;</span><span class="p">:</span> <span class="s2">&quot;/Channel/Application/Readers&quot;</span>
        <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Note: the “role” field of these new policies should say <code class="docutils literal notranslate"><span class="pre">'PEER'</span></code> if <a class="reference external" href="./msp.html#organizational-units">NodeOUs</a> are enabled for the org, and <code class="docutils literal notranslate"><span class="pre">'MEMBER'</span></code> if they are not.</strong></p>
</div>
<div class="section" id="edit-the-channel-configurations">
<span id="edit-the-channel-configurations"></span><h2>Edit the channel configurations<a class="headerlink" href="#edit-the-channel-configurations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="system-channel-updates">
<span id="system-channel-updates"></span><h3>System channel updates<a class="headerlink" href="#system-channel-updates" title="Permalink to this headline">¶</a></h3>
<p>Because configuration changes to the system channel to enable the new lifecycle only involve parameters inside the configuration of the peer organizations within the channel configuration, each peer organization being edited will have to sign the relevant channel configuration update.</p>
<p>However, by default, the system channel can only be edited by system channel admins (typically these are admins of the ordering service organizations and not peer organizations), which means that the configuration updates to the peer organizations in the consortium will have to be proposed by a system channel admin and sent to the relevant peer organization to be signed.</p>
<p>You will need to export the following variables:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">CH_NAME</span></code>: the name of the system channel being updated.</li>
<li><code class="docutils literal notranslate"><span class="pre">CORE_PEER_LOCALMSPID</span></code>: the MSP ID of the organization proposing the channel update. This will be the MSP of one of the ordering service organizations.</li>
<li><code class="docutils literal notranslate"><span class="pre">CORE_PEER_MSPCONFIGPATH</span></code>: the absolute path to the MSP representing your organization.</li>
<li><code class="docutils literal notranslate"><span class="pre">TLS_ROOT_CA</span></code>: the absolute path to the root CA certificate of the organization proposing the system channel update.</li>
<li><code class="docutils literal notranslate"><span class="pre">ORDERER_CONTAINER</span></code>: the name of an ordering node container. When targeting the ordering service, you can target any particular node in the ordering service. Your requests will be forwarded to the leader automatically.</li>
<li><code class="docutils literal notranslate"><span class="pre">ORGNAME</span></code>: the name of the organization you are currently updating.</li>
<li><code class="docutils literal notranslate"><span class="pre">CONSORTIUM_NAME</span></code>: the name of the consortium being updated.</li>
</ul>
<p>Once you have set the environment variables, navigate to <a class="reference external" href="./config_update.html#step-1-pull-and-translate-the-config">Step 1: Pull and translate the config</a>.</p>
<p>Once you have a <code class="docutils literal notranslate"><span class="pre">modified_config.json</span></code>, add the lifecycle organization policy (as listed in <code class="docutils literal notranslate"><span class="pre">enable_lifecycle.json</span></code>) using this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jq</span> <span class="o">-</span><span class="n">s</span> <span class="s2">&quot;.[0] * {</span><span class="se">\&quot;</span><span class="s2">channel_group</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">groups</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">Consortiums</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">groups</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">$CONSORTIUM_NAME</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">groups</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">$ORGNAME</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">policies</span><span class="se">\&quot;</span><span class="s2">: .[1].$</span><span class="si">{ORGNAME}</span><span class="s2">Policies}}}}}}}}&quot;</span> <span class="n">config</span><span class="o">.</span><span class="n">json</span> <span class="o">./</span><span class="n">enable_lifecycle</span><span class="o">.</span><span class="n">json</span> <span class="o">&gt;</span> <span class="n">modified_config</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>Then, follow the steps at <a class="reference external" href="./config_update.html#step-3-re-encode-and-submit-the-config">Step 3: Re-encode and submit the config</a>.</p>
<p>As stated above, these changes will have to be proposed by a system channel admin and sent to the relevant peer organization for signature.</p>
</div>
<div class="section" id="application-channel-updates">
<span id="application-channel-updates"></span><h3>Application channel updates<a class="headerlink" href="#application-channel-updates" title="Permalink to this headline">¶</a></h3>
<div class="section" id="edit-the-peer-organizations">
<span id="edit-the-peer-organizations"></span><h4>Edit the peer organizations<a class="headerlink" href="#edit-the-peer-organizations" title="Permalink to this headline">¶</a></h4>
<p>We need to perform a similar set of edits to all of the organizations on all
application channels.</p>
<p>Note that unlike the system channel, peer organizations are able to make configuration update requests to application channels. If you are making a configuration change to your own organization, you will be able to make these changes without needing the signature of other organizations. However, if you are attempting to make a change to a different organization, that organization will have to approve the change.</p>
<p>You will need to export the following variables:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">CH_NAME</span></code>: the name of the application channel being updated.</li>
<li><code class="docutils literal notranslate"><span class="pre">ORGNAME</span></code>: The name of the organization you are currently updating.</li>
<li><code class="docutils literal notranslate"><span class="pre">TLS_ROOT_CA</span></code>: the absolute path to the TLS cert of your ordering node.</li>
<li><code class="docutils literal notranslate"><span class="pre">CORE_PEER_MSPCONFIGPATH</span></code>: the absolute path to the MSP representing your organization.</li>
<li><code class="docutils literal notranslate"><span class="pre">CORE_PEER_LOCALMSPID</span></code>: the MSP ID of the organization proposing the channel update. This will be the MSP of one of the peer organizations.</li>
<li><code class="docutils literal notranslate"><span class="pre">ORDERER_CONTAINER</span></code>: the name of an ordering node container. When targeting the ordering service, you can target any particular node in the ordering service. Your requests will be forwarded to the leader automatically.</li>
</ul>
<p>Once you have set the environment variables, navigate to <a class="reference external" href="./config_update.html#step-1-pull-and-translate-the-config">Step 1: Pull and translate the config</a>.</p>
<p>Once you have a <code class="docutils literal notranslate"><span class="pre">modified_config.json</span></code>, add the lifecycle organization policy (as listed in <code class="docutils literal notranslate"><span class="pre">enable_lifecycle.json</span></code>) using this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jq</span> <span class="o">-</span><span class="n">s</span> <span class="s2">&quot;.[0] * {</span><span class="se">\&quot;</span><span class="s2">channel_group</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">groups</span><span class="se">\&quot;</span><span class="s2">:{</span><span class="se">\&quot;</span><span class="s2">Application</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">groups</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">$ORGNAME</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">policies</span><span class="se">\&quot;</span><span class="s2">: .[1].$</span><span class="si">{ORGNAME}</span><span class="s2">Policies}}}}}}&quot;</span> <span class="n">config</span><span class="o">.</span><span class="n">json</span> <span class="o">./</span><span class="n">enable_lifecycle</span><span class="o">.</span><span class="n">json</span> <span class="o">&gt;</span> <span class="n">modified_config</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>Then, follow the steps at <a class="reference external" href="./config_update.html#step-3-re-encode-and-submit-the-config">Step 3: Re-encode and submit the config</a>.</p>
</div>
<div class="section" id="edit-the-application-channels">
<span id="edit-the-application-channels"></span><h4>Edit the application channels<a class="headerlink" href="#edit-the-application-channels" title="Permalink to this headline">¶</a></h4>
<p>After all of the application channels have been <a class="reference external" href="./upgrade_to_newest_version.html#capabilities">updated to include V2_0 capabilities</a>,
endorsement policies for the new chaincode lifecycle must be added to each
channel.</p>
<p>You can set the same environment you set when updating the peer organizations. Note that in this case you will not be updating the configuration of an org in the configuration, so the <code class="docutils literal notranslate"><span class="pre">ORGNAME</span></code> variable will not be used.</p>
<p>Once you have set the environment variables, navigate to <a class="reference external" href="./config_update.html#step-1-pull-and-translate-the-config">Step 1: Pull and translate the config</a>.</p>
<p>Once you have a <code class="docutils literal notranslate"><span class="pre">modified_config.json</span></code>, add the channel endorsement policy (as listed in <code class="docutils literal notranslate"><span class="pre">enable_lifecycle.json</span></code>) using this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jq</span> <span class="o">-</span><span class="n">s</span> <span class="s1">&#39;.[0] * {&quot;channel_group&quot;:{&quot;groups&quot;:{&quot;Application&quot;: {&quot;policies&quot;: .[1].appPolicies}}}}&#39;</span> <span class="n">config</span><span class="o">.</span><span class="n">json</span> <span class="o">./</span><span class="n">enable_lifecycle</span><span class="o">.</span><span class="n">json</span> <span class="o">&gt;</span> <span class="n">modified_config</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>Then, follow the steps at <a class="reference external" href="./config_update.html#step-3-re-encode-and-submit-the-config">Step 3: Re-encode and submit the config</a>.</p>
<p>For this channel update to be approved, the policy for modifying the <code class="docutils literal notranslate"><span class="pre">Channel/Application</span></code> section of the configuration must be satisfied. By default, this is a <code class="docutils literal notranslate"><span class="pre">MAJORITY</span></code> of the peer organizations on the channel.</p>
</div>
<div class="section" id="edit-channel-acls-optional">
<span id="edit-channel-acls-optional"></span><h4>Edit channel ACLs (optional)<a class="headerlink" href="#edit-channel-acls-optional" title="Permalink to this headline">¶</a></h4>
<p>The following <a class="reference external" href="./access_control.html">Access Control List (ACL)</a> in <code class="docutils literal notranslate"><span class="pre">enable_lifecycle.json</span></code> are the default values for the new lifecycle, though you have the option to change them depending on your use case.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;acls&quot;</span><span class="p">:</span> <span class="p">{</span>
 <span class="s2">&quot;_lifecycle/CheckCommitReadiness&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;policy_ref&quot;</span><span class="p">:</span> <span class="s2">&quot;/Channel/Application/Writers&quot;</span>
 <span class="p">},</span>
 <span class="s2">&quot;_lifecycle/CommitChaincodeDefinition&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;policy_ref&quot;</span><span class="p">:</span> <span class="s2">&quot;/Channel/Application/Writers&quot;</span>
 <span class="p">},</span>
 <span class="s2">&quot;_lifecycle/QueryChaincodeDefinition&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;policy_ref&quot;</span><span class="p">:</span> <span class="s2">&quot;/Channel/Application/Readers&quot;</span>
 <span class="p">},</span>
 <span class="s2">&quot;_lifecycle/QueryChaincodeDefinitions&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;policy_ref&quot;</span><span class="p">:</span> <span class="s2">&quot;/Channel/Application/Readers&quot;</span>
</pre></div>
</div>
<p>You can leave the same environment in place as when you previously edited application channels.</p>
<p>Once you have the environment variables set, navigate to <a class="reference external" href="./config_update.html#step-1-pull-and-translate-the-config">Step 1: Pull and translate the config</a>.</p>
<p>Once you have a <code class="docutils literal notranslate"><span class="pre">modified_config.json</span></code>, add the ACLs (as listed in <code class="docutils literal notranslate"><span class="pre">enable_lifecycle.json</span></code>) using this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jq</span> <span class="o">-</span><span class="n">s</span> <span class="s1">&#39;.[0] * {&quot;channel_group&quot;:{&quot;groups&quot;:{&quot;Application&quot;: {&quot;values&quot;: {&quot;ACLs&quot;: {&quot;value&quot;: {&quot;acls&quot;: .[1].acls}}}}}}}&#39;</span> <span class="n">config</span><span class="o">.</span><span class="n">json</span> <span class="o">./</span><span class="n">enable_lifecycle</span><span class="o">.</span><span class="n">json</span> <span class="o">&gt;</span> <span class="n">modified_config</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>Then, follow the steps at <a class="reference external" href="./config_update.html#step-3-re-encode-and-submit-the-config">Step 3: Re-encode and submit the config</a>.</p>
<p>For this channel update to be approved, the policy for modifying the <code class="docutils literal notranslate"><span class="pre">Channel/Application</span></code> section of the configuration must be satisfied. By default, this is a <code class="docutils literal notranslate"><span class="pre">MAJORITY</span></code> of the peer organizations on the channel.</p>
</div>
</div>
</div>
<div class="section" id="enable-new-lifecycle-in-core-yaml">
<span id="enable-new-lifecycle-in-core-yaml"></span><h2>Enable new lifecycle in <code class="docutils literal notranslate"><span class="pre">core.yaml</span></code><a class="headerlink" href="#enable-new-lifecycle-in-core-yaml" title="Permalink to this headline">¶</a></h2>
<p>If you follow <a class="reference external" href="./upgrading_your_components.html#overview">the recommended process</a> for using a tool like <code class="docutils literal notranslate"><span class="pre">diff</span></code> to compare the new version of <code class="docutils literal notranslate"><span class="pre">core.yaml</span></code> packaged with the binaries with your old one, you will not need to whitelist <code class="docutils literal notranslate"><span class="pre">_lifecycle:</span> <span class="pre">enable</span></code> because the new <code class="docutils literal notranslate"><span class="pre">core.yaml</span></code> has added it under <code class="docutils literal notranslate"><span class="pre">chaincode/system</span></code>.</p>
<p>However, if you are updating your old node YAML file directly, you will have to add <code class="docutils literal notranslate"><span class="pre">_lifecycle:</span> <span class="pre">enable</span></code> to the system chaincodes whitelist.</p>
<p>For more information about upgrading nodes, check out <a class="reference external" href="./upgrading_your_components.html">Upgrading your components</a>.</p>
<!--- Licensed under Creative Commons Attribution 4.0 International License
https://creativecommons.org/licenses/by/4.0/ --></div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="command_ref.html" class="btn btn-neutral float-right" title="Commands Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="updating_capabilities.html" class="btn btn-neutral" title="Updating the capability level of a channel" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Hyperledger 2020.
    <br>
      <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
        <img alt="Creative Commons License" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'master',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>